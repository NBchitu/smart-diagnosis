# 步进式诊断功能演示指南

## 🎯 功能概述

智能诊断助手2.0已升级为**步进式诊断模式**，提供更专业、更人性化的网络故障诊断体验。

## 🚀 快速开始

### 1. 启动服务
```bash
# 前端服务
cd frontend && yarn dev

# 后端服务 (可选，用于完整功能)
cd backend && python start_dev.py
```

### 2. 访问页面
打开浏览器访问：`http://localhost:3000/smart-diagnosis`

## 📋 功能演示

### 演示场景1: 网络连接慢
**用户输入**: "网络连接很慢，打开网页要等很久"

**预期流程**:
1. **AI分析**: 分析问题并制定3步诊断计划
2. **第1步**: Ping测试 → 检查基础连通性
3. **AI评估**: 分析延迟和丢包情况
4. **第2步**: 连通性检查 → 全面网络状态检查
5. **AI评估**: 综合分析网络质量
6. **第3步**: 网关信息 → 检查路由配置
7. **最终报告**: 完整诊断结果和建议

### 演示场景2: WiFi问题
**用户输入**: "WiFi信号不稳定，时强时弱"

**预期流程**:
1. **AI分析**: 识别无线网络问题
2. **第1步**: WiFi扫描 → 检查周围WiFi环境
3. **AI评估**: 分析信号强度和干扰
4. **第2步**: Ping测试 → 测试无线连接质量
5. **AI评估**: 评估网络稳定性
6. **最终报告**: WiFi优化建议

### 演示场景3: 无法访问网站
**用户输入**: "无法访问某些网站"

**预期流程**:
1. **AI分析**: 诊断访问问题
2. **第1步**: Ping测试 → 检查目标可达性
3. **AI评估**: 分析连接状态
4. **第2步**: 连通性检查 → 检查DNS解析
5. **AI评估**: 诊断访问障碍
6. **最终报告**: 解决方案建议

## 🎨 界面特性

### 进度指示器
- 显示当前步骤: `第 1/3 步`
- 圆点进度条: ●●○ (已完成/进行中/待执行)
- 实时更新诊断进度

### 消息类型
- 📝 **用户问题**: 蓝色气泡，右对齐
- 🤖 **AI分析**: 蓝色卡片，包含问题分析和诊断计划
- 🔧 **工具推荐**: 绿色卡片，包含工具信息和执行按钮
- 📊 **执行结果**: 可视化卡片，展示工具输出
- 🔍 **AI评估**: 紫色卡片，包含发现和建议
- ⏭️ **继续提示**: 黄色卡片，询问是否进行下一步
- 🎉 **完成报告**: 绿色卡片，最终诊断总结

### 交互体验
- 自动滚动到最新消息
- 加载状态指示
- 禁用重复提交
- 错误处理和提示

## 🧪 测试验证

### 自动化测试
```bash
# 运行完整测试
./scripts/test-stepwise-diagnosis.sh

# 预期结果: 所有✅通过
```

### 手动测试步骤
1. **基础功能测试**
   - 输入问题，检查AI分析
   - 验证工具推荐显示
   - 测试工具执行按钮

2. **步进式流程测试**
   - 执行第一个工具
   - 检查AI评估结果
   - 点击"进行下一步"按钮
   - 验证完整流程

3. **错误处理测试**
   - 输入空问题
   - 网络断开测试
   - API错误处理

## 💡 使用技巧

### 问题描述建议
**有效描述**:
- "网络连接很慢"
- "无法访问baidu.com"
- "WiFi经常断线"
- "打开网页加载缓慢"

**避免描述**:
- 过于简单: "网络有问题"
- 过于复杂: "昨天开始网络就不行了,有时快有时慢..."

### 最佳实践
1. **具体描述**: 明确问题现象和影响
2. **耐心等待**: AI分析需要几秒钟
3. **按步执行**: 按照推荐顺序执行工具
4. **查看评估**: 认真阅读AI对每步的评估
5. **保存报告**: 最终报告包含完整诊断信息

## 🔧 技术细节

### API接口
```typescript
// 问题分析
POST /api/ai-diagnosis-stepwise
{
  "action": "analyze",
  "message": "网络连接很慢"
}

// 获取下一步
POST /api/ai-diagnosis-stepwise
{
  "action": "get_next_step",
  "context": { /* 诊断上下文 */ }
}

// 结果评估
POST /api/ai-diagnosis-stepwise
{
  "action": "evaluate_result",
  "context": { /* 诊断上下文 */ },
  "toolResult": { /* 工具执行结果 */ }
}
```

### 诊断上下文
```typescript
interface DiagnosisContext {
  originalProblem: string;    // 原始问题
  currentStep: number;        // 当前步骤
  totalSteps: number;         // 总步骤数
  executedTools: Tool[];      // 已执行工具
  isComplete: boolean;        // 是否完成
}
```

## 🎯 演示要点

### 对比原有功能
**原有方式**: 一次性显示所有工具 → 用户自选执行
**新方式**: 逐步推荐 → 执行 → 评估 → 继续

### 核心优势
1. **专业引导**: 按照网络诊断最佳实践
2. **智能评估**: AI分析每步结果
3. **用户友好**: 步骤清晰，进度可视
4. **完整报告**: 最终提供综合诊断

### 适用场景
- 网络故障排查
- 性能问题诊断
- 连接问题定位
- 配置问题检查

## 📊 演示数据

### 测试问题库
```
基础问题:
- "网络连接很慢"
- "无法访问网站"
- "WiFi信号不稳定"

进阶问题:
- "网页加载缓慢但聊天软件正常"
- "只能访问国内网站"
- "网络时快时慢很不稳定"

专业问题:
- "DNS解析异常"
- "路由表配置问题"
- "数据包丢失严重"
```

### 预期AI分析
```json
{
  "analysis": "检测到网络性能问题...",
  "reasoning": "需要从基础连通性开始排查...",
  "urgency": "medium",
  "totalSteps": 3,
  "diagnosticPlan": ["ping", "connectivity_check", "gateway_info"]
}
```

## 🎬 演示脚本

### 完整演示流程 (5分钟)
1. **开场** (30秒)
   - 介绍步进式诊断概念
   - 展示页面界面

2. **功能演示** (3分钟)
   - 输入问题: "网络连接很慢"
   - 观看AI分析过程
   - 执行第一个工具
   - 查看AI评估结果
   - 进行下一步操作
   - 完成诊断流程

3. **特性说明** (1分钟)
   - 进度指示器
   - 消息类型
   - 交互体验

4. **对比总结** (30秒)
   - 与原有方式对比
   - 优势和价值

### 常见问题解答
**Q: 为什么要步进式而不是一次性？**
A: 步进式更符合专业诊断流程，每步都有明确目的和AI评估。

**Q: 可以跳过某些步骤吗？**
A: 系统会智能判断，某些步骤可能根据结果自动跳过。

**Q: 如果工具执行失败怎么办？**
A: 系统会提示错误，用户可以重试或继续下一步。

## 🔗 相关资源

- [技术实现文档](STEPWISE_DIAGNOSIS_IMPLEMENTATION.md)
- [测试脚本](../scripts/test-stepwise-diagnosis.sh)
- [API文档](../frontend/app/api/ai-diagnosis-stepwise/route.ts)
- [前端组件](../frontend/components/ai-diagnosis/StepwiseDiagnosisInterface.tsx)

---

**演示准备**: ✅ 完成  
**功能状态**: 🚀 可用  
**文档状态**: 📝 完整  

现在可以开始您的步进式诊断功能演示了！ 