# WiFi扫描分析聊天卡片功能测试指南

## 测试前准备

### 1. 服务启动确认
确保以下服务正在运行：
- 前端开发服务器：`http://localhost:3000`
- 后端Python服务：`http://localhost:8000`

启动命令：
```bash
# 前端服务
cd frontend && yarn dev

# 后端服务  
cd backend && python start_dev.py
```

### 2. 系统要求
- macOS系统（支持airport命令）或Linux系统（支持iwlist/iw命令）
- WiFi网络连接或WiFi适配器
- 浏览器支持现代JavaScript

## 测试步骤

### 步骤1：访问智能诊断页面
1. 打开浏览器访问：`http://localhost:3000/smart-diagnosis`
2. 确认页面加载成功，显示"故障诊断AI魔盒1.0"标题
3. 确认聊天界面正常显示

### 步骤2：触发WiFi诊断
1. 在聊天输入框中输入WiFi相关问题，例如：
   - "我的WiFi信号很弱，怎么办？"
   - "网络速度慢，能帮我检查一下WiFi吗？"
   - "WiFi连接不稳定"
   - "想优化我的WiFi网络"

2. 点击发送按钮或按Enter键发送消息

### 步骤3：AI分析和工具推荐
1. **预期结果**：AI会分析用户问题并显示"AI 问题分析"卡片
2. **验证要点**：
   - 分析卡片包含诊断思路、紧急程度、计划步骤
   - 系统识别这是WiFi相关问题
   - 显示步进式诊断计划

3. **自动推荐WiFi工具**：
   - 系统自动进入第一步诊断
   - 显示绿色的"WiFi扫描"工具卡片
   - 工具卡片包含描述、推荐理由、预估时间

### 步骤4：执行WiFi扫描
1. 在WiFi扫描工具卡片中点击"立即执行"按钮
2. **预期状态变化**：
   - 按钮变为"执行中..."状态
   - 显示加载动画
   - 后台调用WiFi扫描API

### 步骤5：验证扫描结果卡片
执行完成后，应显示`WiFiScanResultCard`组件：

#### 5.1 卡片头部验证
- **状态图标**：根据WiFi状态显示对应颜色的图标
- **标题**："WiFi扫描分析结果"
- **网络数量**：显示"发现 X 个网络"
- **状态徽章**：显示整体WiFi状态（WiFi状态优秀/良好/需要优化/未连接WiFi）

#### 5.2 当前WiFi状态区域（如已连接）
- **网络名称**：当前连接的WiFi SSID
- **信号强度**：以dBm为单位显示，带颜色编码
- **信号评级**：优秀/良好/一般/较差
- **信道信息**：当前使用的信道号
- **频段信息**：2.4GHz或5GHz
- **状态徽章**：信号质量徽章

#### 5.3 网络统计概览
- **2.4GHz网络卡片**：
  - 显示蓝色图标和"2.4GHz网络"标签
  - 数量统计
  - 百分比占比
- **5GHz网络卡片**：
  - 显示紫色图标和"5GHz网络"标签  
  - 数量统计
  - 百分比占比

#### 5.4 标签页功能验证

**网络列表标签**：
1. 点击"网络列表"标签（应为默认选中）
2. 验证显示内容：
   - 每个网络一行，包含信号图标、网络名称、信道、加密方式、信号强度
   - 信号强度颜色编码正确（绿色/黄色/红色）
   - 默认显示前5个网络
   - 如果网络总数>5，显示"显示全部 X 个网络"按钮
   - 点击展开按钮能显示所有网络
   - 再次点击能收起显示

**信道分析标签**：
1. 点击"信道分析"标签
2. 验证显示内容：
   - 显示ChannelInterferenceChart组件
   - 2.4GHz和5GHz频段的柱状图
   - 每个信道的网络数量统计
   - 图表交互功能正常

**优化建议标签**：
1. 点击"优化建议"标签  
2. 验证显示内容：
   - 如果需要优化：显示黄色警告卡片，列出具体原因
   - 如果无需优化：显示绿色确认卡片
   - 推荐信道列表（如有）：显示信道号、使用网络数、预期改善百分比

#### 5.5 底部时间戳
- 显示扫描时间
- 格式为本地化的日期时间字符串

### 步骤6：AI结果评估
扫描完成后，AI应该会：
1. 显示"AI 结果评估"紫色卡片
2. 提供扫描结果的智能分析
3. 给出具体的发现和建议
4. 根据结果决定是否需要进行下一步诊断

## 测试数据验证

### 1. 网络扫描数据
- **网络数量**：应发现真实的WiFi网络（非固定的模拟数据）
- **信号强度**：数值应为负数（-30到-90 dBm范围）
- **信道信息**：应为有效的WiFi信道号
- **加密方式**：应显示实际的加密类型（WPA2, WPA3等）

### 2. 信道分析数据
- **频段分布**：2.4GHz和5GHz网络数量应合理
- **信道统计**：每个信道的网络数量应准确
- **干扰分析**：应基于实际扫描结果计算

### 3. 优化建议数据
- **需要优化判断**：基于实际信号强度和信道拥堵情况
- **推荐信道**：应为相对空闲的信道
- **改善预测**：百分比应为合理数值

## 常见问题排查

### 1. WiFi扫描失败
**症状**：显示"WiFi扫描失败"错误
**可能原因**：
- WiFi适配器权限不足
- 系统不支持扫描命令
- 后端服务未启动

**解决方法**：
- 检查后端日志确认错误详情
- 确认系统有airport或iwlist命令
- 尝试手动运行扫描命令验证

### 2. 数据显示异常
**症状**：显示模拟数据或数据缺失
**可能原因**：
- 后端扫描返回空结果
- API数据格式不匹配
- 前端数据处理错误

**解决方法**：
- 检查浏览器控制台错误信息
- 验证API返回数据格式
- 查看后端日志确认扫描结果

### 3. 卡片渲染问题
**症状**：卡片显示不完整或样式异常
**可能原因**：
- CSS样式冲突
- 组件数据类型错误
- 响应式布局问题

**解决方法**：
- 检查浏览器开发者工具
- 验证传入组件的数据结构
- 测试不同屏幕尺寸

## 性能验证

### 1. 响应时间
- WiFi扫描执行时间应在5-15秒内
- 卡片渲染应即时完成
- 标签页切换应流畅无延迟

### 2. 内存使用
- 大量网络列表不应导致内存泄漏
- 图表组件应正确清理资源
- 重复扫描不应累积内存使用

### 3. 移动端适配
- 在移动设备上测试界面布局
- 验证触摸交互功能
- 确认文字大小和间距合适

## 验收标准

### 功能性验收
- [ ] WiFi扫描能正确执行并返回真实数据
- [ ] 所有标签页内容正确显示
- [ ] 信道分析图表功能正常
- [ ] 优化建议逻辑合理
- [ ] AI评估准确反映扫描结果

### 用户体验验收
- [ ] 界面响应流畅，无卡顿
- [ ] 错误提示友好明确
- [ ] 移动端体验良好
- [ ] 操作流程符合直觉

### 技术质量验收
- [ ] 无JavaScript控制台错误
- [ ] API调用稳定可靠
- [ ] 组件代码结构清晰
- [ ] 数据类型安全处理

通过以上全面的测试，可以确保WiFi扫描分析聊天卡片功能在各种场景下都能稳定可靠地工作。 